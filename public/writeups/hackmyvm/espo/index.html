<!DOCTYPE html>
<html lang="en" dir="auto" data-theme="dark">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
<title>Espo | Hack Stark ×͜×</title>
<meta name="keywords" content="">
<meta name="description" content="Writeup de la máquina Espo en HackMyVM.">
<meta name="author" content="">
<link rel="canonical" href="http://localhost:1313/writeups/hackmyvm/espo/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.fd5566c526ae48aadabd950798a2dc3568536401560eae5caac3765a42a9e7b5.css" integrity="sha256-/VVmxSauSKravZUHmKLcNWhTZAFWDq5cqsN2WkKp57U=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/writeups/hackmyvm/espo/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript><link rel='stylesheet' href='/css/custom.css'>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">

<script src="/js/main.js" defer></script>

<link rel="icon" type="image/png" href="/images/logo.png">
<link rel="apple-touch-icon" href="/images/logo.png">
<link rel="shortcut icon" href="/images/logo.png">
<meta name="theme-color" content="#2E3440">

</head>
<body id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Hack Stark ×͜× (Alt + H)">Hack Stark ×͜×</a>
            <div class="logo-switches">
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/writeups/" title="WriteUps">
                    <span>WriteUps</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<div class="post-container">
  <article class="post-single">
    <header class="post-header">
      
      <h1 class="post-title entry-hint-parent">
        Espo
      </h1>
      <div class="post-description">
        Writeup de la máquina Espo en HackMyVM.
      </div>
      <div class="post-meta"><span title='2026-01-09 00:00:00 +0000 UTC'>January 9, 2026</span>&nbsp;·&nbsp;<span>5 min</span>

</div>

      <br />

      <h4>Tags:</h4>

      <br />
      <ul class="post-tags">
      </ul>
    </header> 
    <div class="post-content"><h1 id="enumeración">Enumeración<a hidden class="anchor" aria-hidden="true" href="#enumeración">#</a></h1>
<p>Comenzamos identificando la máquina víctima con ayuda de <strong>Arp-Scan</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>arp-scan -I ens33 --localnet --ignoredups
</span></span></code></pre></div><p><img alt="img1" loading="lazy" src="/img/Pasted%20image%2020260107004626.png"></p>
<p>Ya con la IP identificada, podemos intentar intuir con ayuda de ping el sistema operativo:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ping -c <span style="color:#ae81ff">1</span> 192.168.1.87
</span></span></code></pre></div><p><img alt="img2" loading="lazy" src="/img/Pasted%20image%2020260107005218.png"></p>
<p>Como podemos observar, el <code>ttl=64</code> nos permite intuir que tenemos una máquina Linux.</p>
<p>Vamos a comenzar con un escaneo de puertos para identificar los que se encuentran abiertos, esto con ayuda de <strong>Nmap</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nmap -p- --open -sS --min-rate <span style="color:#ae81ff">5000</span> -n -v -Pn 192.168.1.87 -oG allPorts
</span></span></code></pre></div><p><img alt="img3" loading="lazy" src="/img/Pasted%20image%2020260107005536.png"></p>
<p>Como podemos observar, tenemos los puertos <code>80 y 22</code> abiertos, vamos a tratar de con <strong>Nmap</strong>d obtener más información sobre los mismos:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nmap -p80,22 -sVC 192.168.1.87 -oN target
</span></span></code></pre></div><p><img alt="img4" loading="lazy" src="/img/Pasted%20image%2020260107005759.png"></p>
<p>Podemos observar, cómo es que está corriendo los servicios de SSH y HTTP con Nginx.</p>
<p>Lo primero es identificar qué tenemos en HTTP y, mientras se abre la web vamos a ver si logramos identificar algo especial con <strong>Whatweb</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>whatweb http://192.168.1.87
</span></span></code></pre></div><p><img alt="img5" loading="lazy" src="/img/Pasted%20image%2020260107010245.png"></p>
<p>Como podemos observar, corre <code>php 8.2.7</code>, tenemos <code>nginx</code> y pues nada mas, en este punto veamos qué tenemos en la web:</p>
<p><img alt="img6" loading="lazy" src="/img/Pasted%20image%2020260107010434.png"></p>
<p>Con ayuda de <code>Wappalizer</code> podemos intentar ver información extra:</p>
<p><img alt="img7" loading="lazy" src="/img/Pasted%20image%2020260107010529.png"></p>
<p>Podemos observar que tiene <code>Frameworks</code> y <code>Librerías</code> de Java Script.</p>
<p>Bueno, en la web se intentó con credenciales por defecto y se intentó comprobar si se podía enumerar usuarios, que no se logró. En este punto vamos a realizar una búsqueda por directorios con ayuda de <strong>Gobuster</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>gobuster dir -u http://192.168.1.87 -w /usr/share/seclists/Discovery/Web-Content/DirBuster-2007_directory-list-2.3-medium.txt
</span></span></code></pre></div><p><img alt="img8" loading="lazy" src="/img/Pasted%20image%2020260107133038.png"></p>
<p>Vemos algunas rutas que, al parecer, no podemos visitar. Ahora, un concepto rápido es que en <code>nginx</code> tenemos o se suelen definir <strong>Alias</strong> para algunas rutas donde, si esto no se realizó correctamente, se podrían, mediante un <strong>Path Traversal</strong> exponer archivos y descubrirlos mediante fuzzing.</p>
<p>Entonces, con lo anterior claro, encontramos un error al definir el alias de admin y lo podemos comprobar de la siguiente manera:</p>
<ul>
<li>
<p>Web <code>admin</code>:
<img alt="img9" loading="lazy" src="/img/Pasted%20image%2020260107134633.png"></p>
</li>
<li>
<p>Con la inyección logramos recargar la misma web llamando directo al archivo:
<img alt="img10" loading="lazy" src="/img/Pasted%20image%2020260107134740.png"></p>
</li>
</ul>
<p>Esto no es posible en las otras rutas.</p>
<p>Realizando Fuzzing tenemos que hacerlo lo mejor posible y para encontrar el archivo que necesitamos, vamos a usar en la inyección un <code>_</code> de la siguiente manera:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ffuf -c -u http://192.168.1.87/admin../_FUZZ -w /usr/share/seclists/Discovery/Web-Content/DirBuster-2007_directory-list-2.3-medium.txt
</span></span></code></pre></div><p><img alt="img11" loading="lazy" src="/img/Pasted%20image%2020260107161318.png"></p>
<p>Vemos que acabamos de encontrar una ruta <code>_oldsite</code>, veamos qué contiene:</p>
<p><img alt="img12" loading="lazy" src="/img/Pasted%20image%2020260107161414.png"></p>
<p>Al parecer nada, veamos si es algún directorio y busquemos archivos dentro de está:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>gobuster dir -u http://192.168.1.87/admin../_oldsite/ -w /usr/share/seclists/Discovery/Web-Content/DirBuster-2007_directory-list-2.3-medium.txt
</span></span></code></pre></div><p><img alt="img13" loading="lazy" src="/img/Pasted%20image%2020260107161540.png"></p>
<p>Encontramos un archivo <code>info</code>, veamos su contenido:</p>
<p><img alt="img14" loading="lazy" src="/img/Pasted%20image%2020260107161634.png"></p>
<p>Se descarga un archivo con el siguiente contenido:</p>
<p><img alt="img15" loading="lazy" src="/img/Pasted%20image%2020260107161811.png"></p>
<p>Lo que en realidad nos sirve es que nos avisa que al parecer tenemos dentro de <code>/admin/_odsite</code> un archivo backup con formato zip, busquémoslo:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>gobuster dir -u http://192.168.1.87/admin../_oldsite/ -w /usr/share/seclists/Discovery/Web-Content/DirBuster-2007_directory-list-2.3-medium.txt -x zip
</span></span></code></pre></div><p><img alt="img16" loading="lazy" src="/img/Pasted%20image%2020260107162036.png"></p>
<p>Encontramos un <code>backup.zip</code>, esto es bueno, vamos a descargarlo y descomprimirlo para ver qué contiene:</p>
<p><img alt="img17" loading="lazy" src="/img/Pasted%20image%2020260107162458.png"></p>
<p>Observamos, al parecer, una copia de toda la web, vamos a intentar ver si en algunos archivos de configuración encontramos algo.</p>
<p>Para evitar un poco el ruido general, primero filtré por archivos <code>\*conf\*</code> con ayuda de find y luego a estas rutas le ejecuté un <code>cat</code> donde, por último filtré por todas las coincidencias con las palabras <code>username|user|pass|password</code> quedando de la siguiente manera:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>find . -name <span style="color:#ae81ff">\*</span>conf<span style="color:#ae81ff">\*</span> -exec /bin/cat <span style="color:#f92672">{}</span> <span style="color:#ae81ff">\;</span> | grep -iE <span style="color:#e6db74">&#39;user|username|password|pass&#39;</span>
</span></span></code></pre></div><p><img alt="img18" loading="lazy" src="/img/Pasted%20image%2020260107164644.png"></p>
<p>Podemos ver dos posibles usuarios y sus claves, el cual me interesa es el de <code>admin</code> , por lo tanto vamos a probar este a ver si logramos acceder a la web:</p>
<p><img alt="img19" loading="lazy" src="/img/Pasted%20image%2020260107171922.png"></p>
<p>Como vemos, logramos entrar como <code>admin</code>.</p>
<h1 id="explotación">Explotación<a hidden class="anchor" aria-hidden="true" href="#explotación">#</a></h1>
<p>En este punto, lo primero es identificar la versión del EspoCRM para buscar por vulnerabilidades conocidas.</p>
<p><img alt="img20" loading="lazy" src="/img/Pasted%20image%2020260107175239.png"></p>
<p>Vemos la versión <code>7.2.4</code> vayamos en busca de alguna vulnerabilidad conocida para esta versión:</p>
<p><img alt="img21" loading="lazy" src="/img/Pasted%20image%2020260107180331.png"></p>
<p>Encontramos el repositorio de <a href="https://github.com/josemlwdf/CVE-2023-5965">Github</a> donde vamos a seguir los pasos que nos dice para explotar la vulnerabilidad, donde primero actualizamos y luego subimos la extensión y una vez echo eso, obtendremos lo siguiente en la ruta de <code>/espocrm/webshell.php</code>:</p>
<p><img alt="img22" loading="lazy" src="/img/Pasted%20image%2020260107181051.png"></p>
<p>Ya podemos ejecutar comandos, por lo tanto, vamos a generar una Reverse Shell de la siguiente manera:</p>
<p><img alt="img23" loading="lazy" src="/img/Pasted%20image%2020260107181236.png"></p>
<p><img alt="img24" loading="lazy" src="/img/Pasted%20image%2020260107181247.png"></p>
<p>Perfecto, vamos a darle tratamiento y tendremos ya una bash:</p>
<p><img alt="img25" loading="lazy" src="/img/Pasted%20image%2020260107181346.png"></p>
<h1 id="escalada-de-privilegios">Escalada de Privilegios<a hidden class="anchor" aria-hidden="true" href="#escalada-de-privilegios">#</a></h1>
<p>Realizamos reconocimiento, pero no encontramos nada, pero vamos a revisar mediante un mini script qué comandos se ejecutan a intervalos de tiempo:</p>
<p><img alt="img26" loading="lazy" src="/img/Pasted%20image%2020260107182305.png"></p>
<p>Con este script vamos a intentar detectar alguna cosa.</p>
<p><img alt="img27" loading="lazy" src="/img/Pasted%20image%2020260107182528.png"></p>
<p>Detectamos la ejecución del siguiente script dónde si lo revisamos, encontramos lo siguiente:</p>
<p><img alt="img28" loading="lazy" src="/img/Pasted%20image%2020260107182954.png"></p>
<p>De forma resumida, el script lo que hace es copiar todo lo de <code>/var/shared_medias</code> a el <code>/home/madie</code> del usuario, esto nosotros lo podemos aprovechar y es que podemos intentar crear un archivo con el mismo nombre y que contenga el mismo script con un detalle, y es que al final generemos una reverse shell. Al ejecutarse el script, lo que sucederá es que remplazará el script en la carpeta y, al volverse a ejecutar, sin importar si tiene permisos de ejecución, debido a que lo hace con <code>/bin/sh</code> se ejecutará obtendremos la reverse shell. Entonces nuestro script malicioso será el siguiente:</p>
<p><img alt="img29" loading="lazy" src="/img/Pasted%20image%2020260107184137.png"></p>
<p>Antes de pasar esto al directorio <code>/var/shared_medias</code> vamos a dejar ya el puerto 444 en escucha y ahí sí podemos ponerlo en el directorio y esperamos la conexión:</p>
<p><img alt="img30" loading="lazy" src="/img/Pasted%20image%2020260107185813.png"></p>
<p>Tenemos ya conexión, al igual que con la anterior, vamos a darle tratamiento:</p>
<p><img alt="img31" loading="lazy" src="/img/Pasted%20image%2020260107185944.png"></p>
<p>Ya estamos como el usuario <code>madie</code> y volvemos a hacer reconocimiento, donde con el comando <code>sudo -l</code> encontramos lo siguiente:</p>
<p><img alt="img32" loading="lazy" src="/img/Pasted%20image%2020260108102540.png"></p>
<p>Vemos que mediante el comando <code>sudo</code> podemos ejecutar el binario de <code>savelog</code> como <code>root</code> por lo tanto, vamos a listar la ayuda a ver qué es lo que se puede hacer:</p>
<p><img alt="img33" loading="lazy" src="/img/Pasted%20image%2020260108102641.png"></p>
<p>Podemos observar que tenemos una opción que nos permite ejecutar script, vamos a investigar la forma de usarla correctamente para intentar obtener una <code>bash</code>.</p>
<p><img alt="img34" loading="lazy" src="/img/Pasted%20image%2020260108103809.png">
Podemos observar que se están ejecutando comandos, por lo que podríamos directamente ejecutar una <code>bash</code> desde allí de la siguiente manera:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo /usr/bin/savelog -x <span style="color:#e6db74">&#34;bash&#34;</span> test3
</span></span></code></pre></div><p><img alt="img35" loading="lazy" src="/img/Pasted%20image%2020260108103913.png"></p>
<p>Máquina terminada.</p>
<p><img alt="img36" loading="lazy" src="/img/Pasted%20image%2020260108104134.png"></p>


    </div>

    <footer class="post-footer">
    </footer>
  </article>

  
  <aside id="sidebar-toc">
    <div class="sidebar-title">Contenido</div>
    <ul id="toc-list"></ul>
  </aside>
</div>

<style>
   
  .post-container {
    display: flex;
    flex-direction: row;
    justify-content: flex-start;
    position: relative;
  }

   
  .post-single {
    display: flex;
    flex-direction: column;
    justify-content: center;
    max-width: 850px;
    padding: 1rem 1rem;
  }

   
  #sidebar-toc {
    position: fixed;
    top: 11%;
    right: 20%;
    width: 260px;
    background-color: rgba(25, 25, 25, 0.95);
    border-radius: 12px;
    padding: 15px 20px;
    color: #fff;
    font-size: 14px;
    max-height: 80vh;
    overflow-y: auto;
    box-shadow: 0 0 15px rgba(0, 0, 0, 0.4);
    z-index: 1000;
    transition: all 0.3s ease;
  }

   
  .sidebar-title {
    font-weight: bold;
    color: #00bfff;
    margin-bottom: 10px;
    text-align: center;
  }

   
  #toc-list {
    list-style: none;
    padding: 0;
    margin: 0;
  }

  #toc-list li {
    margin: 5px 0;
  }

  #toc-list li.h2 {
    margin-left: 10px;
    font-size: 13px;
  }

  #toc-list li.h3 {
    margin-left: 20px;
    font-size: 12px;
  }

  #toc-list a {
    color: #9ad0ff;
    text-decoration: none;
    transition: color 0.2s ease;
  }

  #toc-list a:hover {
    color: #00bfff;
  }

   

   
  @media (max-width: 1700px) {
    #sidebar-toc {
      right: 15%;
      width: 220px;
      font-size: 13px;
    }
  }

   
  @media (max-width: 1440px) {

    .post-container {
      justify-content: center;
    }

    #sidebar-toc {
      position: fixed;
      top: auto;
      bottom: 20px;
      right: 10%;
      width: auto;
      padding: 10px 14px;
      background-color: rgba(0, 0, 0, 0.8);
      border-radius: 8px;
      font-size: 13px;
      max-height: none;
      overflow: visible;
      cursor: pointer;
    }

    #sidebar-toc::after {
      content: "☰ Contenido";
      color: #00bfff;
      font-weight: bold;
    }

     
    #toc-list,
    .sidebar-title {
      display: none;
    }

     
    #sidebar-toc:hover #toc-list {
      display: block;
      position: absolute;
      right: 0;
      bottom: 40px;
      width: 220px;
      background-color: rgba(25, 25, 25, 0.95);
      border-radius: 8px;
      padding: 10px;
    }

    #sidebar-toc:hover .sidebar-title {
      display: block;
      text-align: center;
      margin-bottom: 5px;
    }
  }
</style>


<script>
  document.addEventListener("DOMContentLoaded", function () {
    const content = document.querySelector(".post-content");
    const tocList = document.getElementById("toc-list");
    if (!content || !tocList) return;

    const headings = content.querySelectorAll("h1, h2, h3");
    headings.forEach((heading, index) => {
      const id = heading.id || `section-${index}`;
      heading.id = id;

      const li = document.createElement("li");
      li.classList.add(heading.tagName.toLowerCase());

      const a = document.createElement("a");
      a.href = `#${id}`;
      a.textContent = heading.textContent;

      li.appendChild(a);
      tocList.appendChild(li);
    });
  });
</script>
    </main>
    
<footer class="footer">
        <span>&copy; 2026 <a href="http://localhost:1313/">Hack Stark ×͜×</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu');
    if (menu) {
        
        const scrollPosition = localStorage.getItem("menu-scroll-position");
        if (scrollPosition) {
            menu.scrollLeft = parseInt(scrollPosition, 10);
        }
        
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
</body>

</html>
