<!DOCTYPE html>
<html lang="en" dir="auto" data-theme="dark">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
<title>Griffin | Hack Stark ×͜×</title>
<meta name="keywords" content="linux, remote-command-execution, web-enumeration, port-forwarding, python-script, token-leak, sudoers-misconfig, sudo-privileges">
<meta name="description" content="Writeup de la máquina Griffin en HackMyVM.">
<meta name="author" content="">
<link rel="canonical" href="http://localhost:1313/writeups/hackmyvm/griffin/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.fd5566c526ae48aadabd950798a2dc3568536401560eae5caac3765a42a9e7b5.css" integrity="sha256-/VVmxSauSKravZUHmKLcNWhTZAFWDq5cqsN2WkKp57U=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/writeups/hackmyvm/griffin/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript><link rel='stylesheet' href='/css/custom.css'>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">

<script src="/js/main.js" defer></script>

<link rel="icon" type="image/png" href="/images/logo.png">
<link rel="apple-touch-icon" href="/images/logo.png">
<link rel="shortcut icon" href="/images/logo.png">
<meta name="theme-color" content="#2E3440">

</head>
<body id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Hack Stark ×͜× (Alt + H)">Hack Stark ×͜×</a>
            <div class="logo-switches">
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/writeups/" title="WriteUps">
                    <span>WriteUps</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<div class="post-container">
  <article class="post-single">
    <header class="post-header">
      
      <h1 class="post-title entry-hint-parent">
        Griffin
      </h1>
      <div class="post-description">
        Writeup de la máquina Griffin en HackMyVM.
      </div>
      <div class="post-meta"><span title='2025-11-05 00:00:00 +0000 UTC'>November 5, 2025</span>&nbsp;·&nbsp;<span>8 min</span>

</div>

      <br />

      <h4>Tags:</h4>

      <br />
      <ul class="post-tags">
        <li><a href="http://localhost:1313/tags/linux/">Linux</a></li>
        <li><a href="http://localhost:1313/tags/remote-command-execution/">Remote-Command-Execution</a></li>
        <li><a href="http://localhost:1313/tags/web-enumeration/">Web-Enumeration</a></li>
        <li><a href="http://localhost:1313/tags/port-forwarding/">Port-Forwarding</a></li>
        <li><a href="http://localhost:1313/tags/python-script/">Python-Script</a></li>
        <li><a href="http://localhost:1313/tags/token-leak/">Token-Leak</a></li>
        <li><a href="http://localhost:1313/tags/sudoers-misconfig/">Sudoers-Misconfig</a></li>
        <li><a href="http://localhost:1313/tags/sudo-privileges/">Sudo-Privileges</a></li>
      </ul>
    </header> 
    <div class="post-content"><script>
  window.location.replace("https://starkhack.netlify.app/writeup/hackmyvm/griffin");
</script>
<h1 id="reconocimiento">Reconocimiento<a hidden class="anchor" aria-hidden="true" href="#reconocimiento">#</a></h1>
<p>Vamos a comenzar con un escaneo en red con el objetivo de identificar la máquina vulnerable con ayuda de <strong>Arp-Scan</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>arp-scan -I enss33 --localnet --ignoredups
</span></span></code></pre></div><p><img alt="img1" loading="lazy" src="/img/Pasted%20image%2020251104163301.png"></p>
<p>Como podemos observar ya tenemos la IP de la máquina víctima que es <code>192.168.1.67</code> por lo que intuiremos sistema operativo con ayuda del comando ping:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ping -c <span style="color:#ae81ff">1</span> 192.168.1.67
</span></span></code></pre></div><p><img alt="img2" loading="lazy" src="/img/Pasted%20image%2020251104184850.png"></p>
<p>Como podemos observar tenemos un <code>ttl=64</code> por lo que podemos intuir el sistema operativo <code>Linux</code>.</p>
<p>Bueno, con esto podemos continuar realizando un pequeño escaneo con ayuda de <strong>Nmap</strong> con el objetivo primero de obtener los puertos abiertos:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nmap -p- --open -sS --min-rate <span style="color:#ae81ff">5000</span> -n -v -Pn 192.168.1.67 -oG allPorts
</span></span></code></pre></div><p><img alt="img3" loading="lazy" src="/img/Pasted%20image%2020251104185227.png"></p>
<p>Como podemos observar tenemos los puertos <code>8080</code> y <code>22</code> abiertos. Vamos a realizar un segundo escaneo directamente a estos dos puertos para intentar obtener información sobre los mismos:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nmap -p22,8080 -sVC 192.168.1.67 -oN target
</span></span></code></pre></div><p><img alt="img4" loading="lazy" src="/img/Pasted%20image%2020251104185603.png"></p>
<p>Vemos que en la versión del puerto <code>22-SSH</code> nos habla de ser un Debian, por lo que podemos igualmente intuir un sistema operativo <code>Linux -&gt; Debian</code>.</p>
<p>La verdad en el escaneo no logramos observar nada más por lo que podemos directamente intentar ver la web que corre en el puerto <code>8080</code>:</p>
<p><img alt="img5" loading="lazy" src="/img/Pasted%20image%2020251104185920.png"></p>
<p>No encontramos nada absolutamente aquí y de igual forma wappalyzer no detecta nada, por lo que intentamos un escaneo con whatweb solo para ver que información extra podemos obtener:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>whatweb http://192.168.1.67:8080
</span></span></code></pre></div><p><img alt="img6" loading="lazy" src="/img/Pasted%20image%2020251104190202.png"></p>
<p>Podemos observar como es que por detrás se puede estar implementando <strong>Werkzeug</strong> en su versión 3.1.3 y la versión de <strong>Python</strong> 3.9.2.</p>
<p>Bueno, como no podemos encontrar nada concreto por el momento lo que vamos a hacer es con ayuda de <strong>Gobuster</strong> ver qué rutas tiene esta web:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>gobuster dir -u <span style="color:#e6db74">&#39;http://192.168.1.67:8080&#39;</span> -w &lt;diccionario&gt; -t20 -xl <span style="color:#ae81ff">164</span>
</span></span></code></pre></div><p><img alt="img7" loading="lazy" src="/img/Pasted%20image%2020251104193339.png"></p>
<p>Como podemos observar tenemos dos rutas donde a la de <code>/info</code> si podemos acceder por lo que veamos su contenido:</p>
<p><img alt="img8" loading="lazy" src="/img/Pasted%20image%2020251104193538.png"></p>
<p>Nos indica que podemos usar <code>token=AlphaToken123</code>, podemos intentarlo en <code>/info</code> a ver si funciona:</p>
<p><img alt="img9" loading="lazy" src="/img/Pasted%20image%2020251104193813.png"></p>
<p>Vemos otro token vamos a intentar ahora con ese:</p>
<p><img alt="img10" loading="lazy" src="/img/Pasted%20image%2020251104193840.png"></p>
<p>Otro más veamos que sucede:</p>
<p><img alt="img11" loading="lazy" src="/img/Pasted%20image%2020251104193915.png"></p>
<p>Se repiten, en este punto podemos intentar lo mismo en <code>/debug</code> y veamos que obtenemos:</p>
<p><img alt="img12" loading="lazy" src="/img/Pasted%20image%2020251104194025.png"></p>
<h1 id="explotación">Explotación<a hidden class="anchor" aria-hidden="true" href="#explotación">#</a></h1>
<p>Los otros <code>tokens</code> no fueron validos, pero en este vemos que nos dice que usemos <code>run</code>, veamos que es lo que hace:</p>
<p><img alt="img13" loading="lazy" src="/img/Pasted%20image%2020251104194501.png"></p>
<p>Algo a tener en cuenta es que no funciona ninguno de los parámetros de primeras, vamos a tener que recargar la web varias veces y luego funciona.</p>
<p>Entonces, lo que podemos hacer en este punto es generar una reverse shell de la siguiente manera:</p>
<p><img alt="img14" loading="lazy" src="/img/Pasted%20image%2020251105133503.png"></p>
<p>Ya con el puerto en escucha vamos a generar la reverse shell desde el navegador:</p>
<p><img alt="img15" loading="lazy" src="/img/Pasted%20image%2020251105133656.png"></p>
<p>Excelente ya deberíamos tener la reverse shell:</p>
<p><img alt="img16" loading="lazy" src="/img/Pasted%20image%2020251105133735.png"></p>
<p>Podemos ejecutar el tratamiento a la <code>TTY</code> para podernos mover con la mayor soltura posible:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>script /dev/null -c bash
</span></span><span style="display:flex;"><span>ctrl + z
</span></span><span style="display:flex;"><span>stty raw -echo;fg
</span></span><span style="display:flex;"><span>reset xterm
</span></span></code></pre></div><p><img alt="img17" loading="lazy" src="/img/Pasted%20image%2020251105133912.png"></p>
<h1 id="escalada-de-privilegios">Escalada de Privilegios<a hidden class="anchor" aria-hidden="true" href="#escalada-de-privilegios">#</a></h1>
<p>Bueno ya como el usuario <code>lois</code> ya tenemos la flag de usuario que está en su home:</p>
<p><img alt="img18" loading="lazy" src="/img/Pasted%20image%2020251105135228.png"></p>
<p>En este punto podemos comenzar a buscar una forma de elevar privilegios.</p>
<p>Vamos a ver los puertos abiertos en el sistema:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ss -ntlp
</span></span></code></pre></div><p><img alt="img19" loading="lazy" src="/img/Pasted%20image%2020251105134306.png"></p>
<p>Observamos que tenemos de forma interna el puerto 80 abierto.</p>
<p>Bueno, lo que vamos a hacer en este punto es jugar con la herramienta de chisel, esta nos permitirá realizar un <code>Port Fortwarding</code> para convertir este puerto 80 que tiene la máquina de forma interna en nuestro puerto 80 y así ver su contenido, esto lo vamos a hacer con ayuda de <strong>Chisel</strong></p>
<p>Una vez descargado el binario vamos a tener que enviarlo a la máquina víctima, en este caso yo lo realize levantando un servidor con python3 y descargando con ayuda del comando <code>curl</code>, también podríamos usar el comando <code>wget</code>, pero la máquina no lo tiene:</p>
<p><img alt="img20" loading="lazy" src="/img/Pasted%20image%2020251105135607.png"></p>
<p>Ya con el archivo en las dos máquinas procederemos a ejecutar chisel primero en la máquina atacante de la siguiente manera:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>./chisel server --reverse -p <span style="color:#ae81ff">1234</span>
</span></span></code></pre></div><p><img alt="img21" loading="lazy" src="/img/Pasted%20image%2020251105135952.png"></p>
<p>Ahora en la máquina víctima vamos a tener que ejecutar chisel como cliente de la siguiente manera:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>./chisel client 192.168.1.130:1234 R:80:127.0.0.1:80
</span></span></code></pre></div><p><img alt="img22" loading="lazy" src="/img/Pasted%20image%2020251105140048.png"></p>
<p>Perfecto con esto ya nuestro puerto 80 es el puerto 80 de la máquina víctima por lo que vamos a ver que tenemos en el puerto 80:</p>
<p><img alt="img23" loading="lazy" src="/img/Pasted%20image%2020251105140251.png"></p>
<p>Vemos que tenemos otra web, pero si investigamos no vamos a obtener nada más, así que con ayuda de <strong>Gobuster</strong> vamos a volver a buscar otras rutas dentro de la web:</p>
<p><img alt="img24" loading="lazy" src="/img/Pasted%20image%2020251105140528.png"></p>
<p>Podemos observar una ruta <code>/family</code> vemos cual es su contenido:</p>
<p><img alt="img25" loading="lazy" src="/img/Pasted%20image%2020251105140608.png"></p>
<p>Vemos este panel para iniciar sección. Si regresamos a la web anterior nos lista algunos nombres como <code>peter, lois, brian</code> donde a diferencia de cuando usamos <code>lois</code> y nos sale:</p>
<p><img alt="img26" loading="lazy" src="/img/Pasted%20image%2020251105140850.png"></p>
<p>Con el usuario <code>brian</code> esto cambia y nos dice:</p>
<p><img alt="img27" loading="lazy" src="/img/Pasted%20image%2020251105140928.png"></p>
<p>Esto ya nos indica que el usuario es válido, pero su contraseña NO.</p>
<p>Lo que vamos a hacer es realizar un ataque de fuerza bruta a la contraseña y para esto usare la herramienta que diseñe con python3 para este apartado y la pueden encontrar en el siguiente repo de <a href="https://github.com/danystarrkk/Hacknig-Tools/tree/main/Tools/Web%20Brute%20Force%20(Griffin)"><strong>GitHub</strong><svg xmlns="http://www.w3.org/2000/svg" height="30" width="30" viewBox="0 0 640 440"><!--!Font Awesome Free v7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.--><path fill="#ffffff" d="M237.9 461.4C237.9 463.4 235.6 465 232.7 465C229.4 465.3 227.1 463.7 227.1 461.4C227.1 459.4 229.4 457.8 232.3 457.8C235.3 457.5 237.9 459.1 237.9 461.4zM206.8 456.9C206.1 458.9 208.1 461.2 211.1 461.8C213.7 462.8 216.7 461.8 217.3 459.8C217.9 457.8 216 455.5 213 454.6C210.4 453.9 207.5 454.9 206.8 456.9zM251 455.2C248.1 455.9 246.1 457.8 246.4 460.1C246.7 462.1 249.3 463.4 252.3 462.7C255.2 462 257.2 460.1 256.9 458.1C256.6 456.2 253.9 454.9 251 455.2zM316.8 72C178.1 72 72 177.3 72 316C72 426.9 141.8 521.8 241.5 555.2C254.3 557.5 258.8 549.6 258.8 543.1C258.8 536.9 258.5 502.7 258.5 481.7C258.5 481.7 188.5 496.7 173.8 451.9C173.8 451.9 162.4 422.8 146 415.3C146 415.3 123.1 399.6 147.6 399.9C147.6 399.9 172.5 401.9 186.2 425.7C208.1 464.3 244.8 453.2 259.1 446.6C261.4 430.6 267.9 419.5 275.1 412.9C219.2 406.7 162.8 398.6 162.8 302.4C162.8 274.9 170.4 261.1 186.4 243.5C183.8 237 175.3 210.2 189 175.6C209.9 169.1 258 202.6 258 202.6C278 197 299.5 194.1 320.8 194.1C342.1 194.1 363.6 197 383.6 202.6C383.6 202.6 431.7 169 452.6 175.6C466.3 210.3 457.8 237 455.2 243.5C471.2 261.2 481 275 481 302.4C481 398.9 422.1 406.6 366.2 412.9C375.4 420.8 383.2 435.8 383.2 459.3C383.2 493 382.9 534.7 382.9 542.9C382.9 549.4 387.5 557.3 400.2 555C500.2 521.8 568 426.9 568 316C568 177.3 455.5 72 316.8 72zM169.2 416.9C167.9 417.9 168.2 420.2 169.9 422.1C171.5 423.7 173.8 424.4 175.1 423.1C176.4 422.1 176.1 419.8 174.4 417.9C172.8 416.3 170.5 415.6 169.2 416.9zM158.4 408.8C157.7 410.1 158.7 411.7 160.7 412.7C162.3 413.7 164.3 413.4 165 412C165.7 410.7 164.7 409.1 162.7 408.1C160.7 407.5 159.1 407.8 158.4 408.8zM190.8 444.4C189.2 445.7 189.8 448.7 192.1 450.6C194.4 452.9 197.3 453.2 198.6 451.6C199.9 450.3 199.3 447.3 197.3 445.4C195.1 443.1 192.1 442.8 190.8 444.4zM179.4 429.7C177.8 430.7 177.8 433.3 179.4 435.6C181 437.9 183.7 438.9 185 437.9C186.6 436.6 186.6 434 185 431.7C183.6 429.4 181 428.4 179.4 429.7z"/></svg></a>.
Algo que tenemos que hacer de forma extra es extraer la cookie que tenemos asignada en ese momento y lo podemos hacer con <code>ctrl + shift + c</code> y se desplegara:</p>
<p><img alt="img28" loading="lazy" src="/img/Pasted%20image%2020251105180223.png"></p>
<p>Como vemos en la parte de Storage encontraremos el <code>PHPSESSID</code> del cual necesitamos su valor, ya con esto continuemos.</p>
<p>El uso de la herramienta ya está descrito en el repositorio por lo que directamente ejecutaré el script de la siguiente manera:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>python3 Bruteforce.py -u http://192.168.1.130 -w /usr/share/seclists/Passwords/Leaked-Databases/rockyou.txt -U brian -c gnrou14ivh0tqme7il8h7aqihk
</span></span></code></pre></div><p><img alt="img29" loading="lazy" src="/img/Pasted%20image%2020251105180420.png"></p>
<p>Una vez que la herramienta entre en ejecución será cuestión de esperar para poder ver la contraseña correcta, recomiendo usar el diccionario de <code>rockyou.txt</code> debido a que este cuenta con la contraseña:</p>
<p><img alt="img30" loading="lazy" src="/img/Pasted%20image%2020251105142055.png"></p>
<p>Si este script te ha gustado y a sido de utilidad podrías dejar una estrellita en el repositorio.</p>
<p>Perfecto ya tenemos la contraseña de <code>brian</code> que es <code>savannah</code>. Vamos a iniciar sesión y esto lo vamos a capturar también con BurpSuite para ver que se tramita por detrás:</p>
<p><img alt="img31" loading="lazy" src="/img/Pasted%20image%2020251105142420.png"></p>
<p>Vemos que se nos asigna un Token, este tiene una forma algo extraña por lo que vamos a pasarle a un decode a ver que nos dice:</p>
<p><img alt="img32" loading="lazy" src="/img/Pasted%20image%2020251105142605.png"></p>
<p>Vemos que nos da algunas opciones pero la válida es la que tiene <code>Base 58</code> por lo que vamos a intentar ver que es lo que contiene:</p>
<p><img alt="img33" loading="lazy" src="/img/Pasted%20image%2020251105142716.png"></p>
<p>Esto es excelente, lo que estoy viendo es una cadena en <code>Base64</code> el cómo lo identifico es sencillo y es que casi siempre si no es siempre vamos a encontrar que las cadenas en <code>Base64</code> llevan ese <code>==</code> por lo que vamos a ver que contiene esa cadena:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>echo <span style="color:#e6db74">&#39;bWVnOmxvdmVseWZhbWlseQ==&#39;</span> | base64 -d ;echo
</span></span></code></pre></div><p><img alt="img34" loading="lazy" src="/img/%7BDDF02666-EE84-4C6C-9D6D-7D2AF6E5C9C1%7D.png"></p>
<p>! Perfecto ya tenemos la contraseña del usuario <code>meg</code> por lo que en este punto podemos intentar conectarnos a la máquina como este usuario mediante <code>SSH</code> recordemos que tenemos el servicio activo:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ssh meg@192.168.1.67
</span></span></code></pre></div><p><img alt="img35" loading="lazy" src="/img/Pasted%20image%2020251105143101.png"></p>
<p>Ya estamos como el usuario <code>meg</code> podemos comenzar a analizar con el comando <code>sudo -l</code> si tenemos algún comando que podamos ejecutar como sudo:</p>
<p><img alt="img36" loading="lazy" src="/img/Pasted%20image%2020251105143229.png"></p>
<p>vemos que el usuario <code>meg</code> puede ejecutar el comando <code>/usr/bin/python3 /root/game.py</code>, vemos que es lo que hace:</p>
<p><img alt="img37" loading="lazy" src="/img/Pasted%20image%2020251105143318.png"></p>
<p>Se queda un puerto en escucha podemos intentar conectarnos a ver que es:</p>
<p><img alt="img38" loading="lazy" src="/img/Pasted%20image%2020251105143354.png"></p>
<p>En este caso es una especie de juego, pero vamos a tener que automatizar la resolución de los mismos porque tiene que hacerse de forma rápida y en mi caso el código es el siguiente:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#!/usr/bin/python3</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> socket<span style="color:#f92672">,</span> re<span style="color:#f92672">,</span> hashlib
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">funDecode</span>(text, rot):
</span></span><span style="display:flex;"><span>    resultado <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>, len(text)):
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#39;a&#39;</span> <span style="color:#f92672">&lt;=</span> text[i] <span style="color:#f92672">&lt;=</span> <span style="color:#e6db74">&#39;z&#39;</span>:
</span></span><span style="display:flex;"><span>            valor <span style="color:#f92672">=</span> chr(ord(text[i]) <span style="color:#f92672">-</span> int(rot[i]))
</span></span><span style="display:flex;"><span>            resultado<span style="color:#f92672">+=</span>valor
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            resultado<span style="color:#f92672">+=</span>text[i]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> resultado
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span>  <span style="color:#a6e22e">main</span>():
</span></span><span style="display:flex;"><span>    s <span style="color:#f92672">=</span> socket<span style="color:#f92672">.</span>socket(socket<span style="color:#f92672">.</span>AF_INET, socket<span style="color:#f92672">.</span>SOCK_STREAM)
</span></span><span style="display:flex;"><span>    params <span style="color:#f92672">=</span> (<span style="color:#e6db74">&#39;192.168.1.67&#39;</span>, <span style="color:#ae81ff">6666</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 1 Game: Math operation</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    s<span style="color:#f92672">.</span>connect(params)
</span></span><span style="display:flex;"><span>    data <span style="color:#f92672">=</span> s<span style="color:#f92672">.</span>recv(<span style="color:#ae81ff">1024</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">match</span> <span style="color:#f92672">=</span> re<span style="color:#f92672">.</span>findall(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">(</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">d{1,}</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">s</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">*</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">s</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">d{1,}</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">)</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">s</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">/</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">/</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">s</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">d{1,}&#34;</span>,
</span></span><span style="display:flex;"><span>                       data<span style="color:#f92672">.</span>decode())
</span></span><span style="display:flex;"><span>    result <span style="color:#f92672">=</span> str(eval(<span style="color:#66d9ef">match</span>[<span style="color:#ae81ff">0</span>]))
</span></span><span style="display:flex;"><span>    s<span style="color:#f92672">.</span>sendall(result<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    data <span style="color:#f92672">=</span> s<span style="color:#f92672">.</span>recv(<span style="color:#ae81ff">1024</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 2 Game: rotation cipher</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">match</span> <span style="color:#f92672">=</span> re<span style="color:#f92672">.</span>findall(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">w+</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">{</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">w+</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">}&#34;</span>, data<span style="color:#f92672">.</span>decode())
</span></span><span style="display:flex;"><span>    match2 <span style="color:#f92672">=</span> str(re<span style="color:#f92672">.</span>findall(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">d</span><span style="color:#e6db74">{3}</span><span style="color:#e6db74">&#34;</span>, data<span style="color:#f92672">.</span>decode())[<span style="color:#ae81ff">0</span>]) <span style="color:#f92672">*</span> <span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span>    result <span style="color:#f92672">=</span> funDecode(<span style="color:#66d9ef">match</span>[<span style="color:#ae81ff">0</span>],match2)
</span></span><span style="display:flex;"><span>    s<span style="color:#f92672">.</span>sendall(result<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    data <span style="color:#f92672">=</span> s<span style="color:#f92672">.</span>recv(<span style="color:#ae81ff">1024</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 3 Game: hash md5</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">match</span> <span style="color:#f92672">=</span> re<span style="color:#f92672">.</span>findall(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">d{4,}&#34;</span>, data<span style="color:#f92672">.</span>decode())
</span></span><span style="display:flex;"><span>    resultado <span style="color:#f92672">=</span> <span style="color:#66d9ef">match</span>[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">+</span> <span style="color:#66d9ef">match</span>[<span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>    resultado <span style="color:#f92672">=</span> str(resultado)<span style="color:#f92672">.</span>encode(<span style="color:#e6db74">&#39;utf-8&#39;</span>)
</span></span><span style="display:flex;"><span>    hash <span style="color:#f92672">=</span> hashlib<span style="color:#f92672">.</span>md5(resultado)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    s<span style="color:#f92672">.</span>sendall(hash<span style="color:#f92672">.</span>hexdigest()<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    data <span style="color:#f92672">=</span> s<span style="color:#f92672">.</span>recv(<span style="color:#ae81ff">1024</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    print(data<span style="color:#f92672">.</span>decode())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
</span></span><span style="display:flex;"><span>    main()
</span></span></code></pre></div><p>Vamos a explicar un poco los juegos y nuestro código:</p>
<ul>
<li><strong>Primer Juego:</strong> lo que vamos a encontrar no es más que una operación y tenemos que enviar la respuesta en el script es sencillo su proceso, lo que se hace es capturar mediante expresiones regulares con ayuda de la librería <code>re</code> donde una vez que las obtenemos vamos a evaluarlas con <code>eval()</code> y listo.</li>
<li><strong>Segundo Juego:</strong> este me costó un poco más comprenderlo, en este nos dan dos cosas, una cadena cifrada y una key, lo que en realidad tenemos que hacer es asignar cada dígito de la key a cada letra del string donde si el string es <code>asdk{lfjdlsfj}</code> y su que es <code>443</code> se tendría que hacer:</li>
</ul>
<pre tabindex="0"><code>asdk{lfjdlsfj}
44344344344344
</code></pre><p>Como podemos observar asignamos un valor a cada dígito siguiente la key y este dígito nos indica la rotación que tenemos que hacer, esto ya está automatizado en mi script.</p>
<ul>
<li><strong>Tercer Juego:</strong> en este al parecer tenemos que formar un hash md5 con dos valores numéricos que nos da, donde combinamos los strings no sumamos los números y luego convertimos en md5 y lo enviamos.</li>
</ul>
<blockquote>
<p>Recomendaría si estás aprendiendo replicar el código a tu manera para comprender mucho mejor.</p>
</blockquote>
<p>Si lo ejecutamos vamos a ver lo siguiente:</p>
<p><img alt="img39" loading="lazy" src="/img/Pasted%20image%2020251105143621.png"></p>
<p>en este caso vemos una flag que en realidad es la contraseña del usuario peter solo lo que se encuentra dentro de los <code>{}</code>:</p>
<p><img alt="img40" loading="lazy" src="/img/Pasted%20image%2020251105143743.png"></p>
<p>Ya estamos cerca, podemos ver de igual forma si tenemos algún comando con <code>sudo -l</code> :</p>
<p><img alt="img41" loading="lazy" src="/img/Pasted%20image%2020251105143829.png"></p>
<p>Al parecer podemos ejecutar un editor llamado <code>meg</code> como usuario administrador por lo que vamos a editar el archivo de <code>/etc/sudoers</code> el objetivo es que nos permite la ejecución de sudo sin contraseña y lo vamos a editar de la siguiente manera:</p>
<p><img alt="img42" loading="lazy" src="/img/Pasted%20image%2020251105144158.png"></p>
<p>Agregamos la línea que vemos en la imagen, guardamos y salimos.
Para que funcione vamos a salir del usuario peter y luego volvemos a ingresar y ya con eso podemos hacer un <code>sudo su</code>:</p>
<p><img alt="img43" loading="lazy" src="/img/Pasted%20image%2020251105144629.png"></p>
<p>Listo ya estamos como root y en su ruta encontraremos la flag:</p>
<p><img alt="img44" loading="lazy" src="/img/Pasted%20image%2020251105144707.png"></p>
<p>Ya con esto terminamos la Máquina:</p>
<p><img alt="img45" loading="lazy" src="/img/%7B1CA373A4-ECAB-4BBE-A247-41B9B188B21B%7D.png"></p>


    </div>

    <footer class="post-footer">
    </footer>
  </article>

  
  <aside id="sidebar-toc">
    <div class="sidebar-title">Contenido</div>
    <ul id="toc-list"></ul>
  </aside>
</div>

<style>
   
  .post-container {
    display: flex;
    flex-direction: row;
    justify-content: flex-start;
    position: relative;
  }

   
  .post-single {
    display: flex;
    flex-direction: column;
    justify-content: center;
    max-width: 850px;
    padding: 1rem 1rem;
  }

   
  #sidebar-toc {
    position: fixed;
    top: 11%;
    right: 20%;
    width: 260px;
    background-color: rgba(25, 25, 25, 0.95);
    border-radius: 12px;
    padding: 15px 20px;
    color: #fff;
    font-size: 14px;
    max-height: 80vh;
    overflow-y: auto;
    box-shadow: 0 0 15px rgba(0, 0, 0, 0.4);
    z-index: 1000;
    transition: all 0.3s ease;
  }

   
  .sidebar-title {
    font-weight: bold;
    color: #00bfff;
    margin-bottom: 10px;
    text-align: center;
  }

   
  #toc-list {
    list-style: none;
    padding: 0;
    margin: 0;
  }

  #toc-list li {
    margin: 5px 0;
  }

  #toc-list li.h2 {
    margin-left: 10px;
    font-size: 13px;
  }

  #toc-list li.h3 {
    margin-left: 20px;
    font-size: 12px;
  }

  #toc-list a {
    color: #9ad0ff;
    text-decoration: none;
    transition: color 0.2s ease;
  }

  #toc-list a:hover {
    color: #00bfff;
  }

   

   
  @media (max-width: 1700px) {
    #sidebar-toc {
      right: 15%;
      width: 220px;
      font-size: 13px;
    }
  }

   
  @media (max-width: 1440px) {

    .post-container {
      justify-content: center;
    }

    #sidebar-toc {
      position: fixed;
      top: auto;
      bottom: 20px;
      right: 10%;
      width: auto;
      padding: 10px 14px;
      background-color: rgba(0, 0, 0, 0.8);
      border-radius: 8px;
      font-size: 13px;
      max-height: none;
      overflow: visible;
      cursor: pointer;
    }

    #sidebar-toc::after {
      content: "☰ Contenido";
      color: #00bfff;
      font-weight: bold;
    }

     
    #toc-list,
    .sidebar-title {
      display: none;
    }

     
    #sidebar-toc:hover #toc-list {
      display: block;
      position: absolute;
      right: 0;
      bottom: 40px;
      width: 220px;
      background-color: rgba(25, 25, 25, 0.95);
      border-radius: 8px;
      padding: 10px;
    }

    #sidebar-toc:hover .sidebar-title {
      display: block;
      text-align: center;
      margin-bottom: 5px;
    }
  }
</style>


<script>
  document.addEventListener("DOMContentLoaded", function () {
    const content = document.querySelector(".post-content");
    const tocList = document.getElementById("toc-list");
    if (!content || !tocList) return;

    const headings = content.querySelectorAll("h1, h2, h3");
    headings.forEach((heading, index) => {
      const id = heading.id || `section-${index}`;
      heading.id = id;

      const li = document.createElement("li");
      li.classList.add(heading.tagName.toLowerCase());

      const a = document.createElement("a");
      a.href = `#${id}`;
      a.textContent = heading.textContent;

      li.appendChild(a);
      tocList.appendChild(li);
    });
  });
</script>
    </main>
    
<footer class="footer">
        <span>&copy; 2026 <a href="http://localhost:1313/">Hack Stark ×͜×</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu');
    if (menu) {
        
        const scrollPosition = localStorage.getItem("menu-scroll-position");
        if (scrollPosition) {
            menu.scrollLeft = parseInt(scrollPosition, 10);
        }
        
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
</body>

</html>
